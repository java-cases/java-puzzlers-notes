# 谜题 10：八两

## 背景

复合赋值操作符、字符串连接。

## 代码

给出一个对变量 x 和 i 的声明，使下面代码是一个合法的语句:

```java
x = x + i;
//但是，它并不是:
x += i;
```

## 陷阱

基于前面的谜题，你可能会想：复合赋值操作符比简单赋值操作符的限制要少一些。在一般情况下，这是对的，但是有这么一个领域，在其中简单赋值操作符会显得更宽松一些。

## 解惑

**复合赋值操作符要求两个操作数都是原始类型的，例如 int，或包装了的原始类型，例如 Integer**，但是有一个例外：如果在+=操作符左侧的操作数是 String类型的，那么它允许右侧的操作数是任意类型，在这种情况下，该操作符执行的是字符串连接操作。

**简单赋值操作符(=)允许其左侧的是对象引用类型**，这就显得要宽松许多了：你可以使用它们来表示任何你想要表示的内容，**只要表达式的右侧与左侧的变量是赋值兼容的即可**。

要想用 += 操作符来执行字符串连接操作，你就必须将左侧的变量声明为 String 类型。通过使用直接赋值操作符，字符串连接的结果可以存放到一个 Object 类型的变量中。

## 解决办法或规则

**解决办法**：
```java
Object x = "Buy ";
String i = "Effective Java!";

//简单赋值是合法的，因为 x + i 是 String 类型的，而 String 类型又是与 Object赋值兼容的:
x = x + i;

//复合赋值是非法的，因为左侧是一个 Object 引用类型，而右侧是一个 String类型:
x += i;
```
这个谜题对程序员来说几乎算不上什么教训。


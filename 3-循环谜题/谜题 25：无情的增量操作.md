# 谜题 25：无情的增量操作  

## 背景

后缀增量操作符（postfix increment operator）。

## 代码

下面的程序对一个变量重复地进行增量操作，然后打印它的值。那么这个值是什 么呢？

```java
public class Increment {
    public static void main(String[] args) { 
        int j = 0;
        
        for (int i = 0; i < 100; i++)
            j = j++;
        
        System.out.println(j);
    }
}
```

## 陷阱

乍一看，这个程序可能会打印 100。毕竟，它对 j 做了 100 次增量操作。

可能会 令你感到有些震惊，它打印的不是 100 而是 0。所有的增量操作都无影无踪了， 为什么？   

## 解惑

问题出在了执行增量操作的语句上： 

```java
j = j++;
```

当++操作符被置于一个变量值之后时，其作用就是一个**后缀增量操作符（postfix increment operator）**：表达式 j++的值等于 j 在执行增量操作之前的初始值。因此，前面提到的赋值语句首先保存 j 的值，然后将 j 设置为其值加 1，最后将 j 复位到它的初始值。换句话说，这个赋值操作等价于下面的语句序列： 

```java
int tmp = j;
j = j + 1;
j = tmp; 
```

## 规则或告警

**订正**：只需从循环中移除无关的赋值操作 

```java
for (int i = 0; i < 100; i++)
    j++;  
```

教训：**不要在单个的表达式中对相同的变量赋值超过一次**。 对相同的变量进行多次赋值的表达式会产生混淆，并且很少能够产生你希望的行为。 


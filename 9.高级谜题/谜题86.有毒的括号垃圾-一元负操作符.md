# 谜题 86：有毒的括号垃圾

## 背景

一元负操作符、操作符优先级。

## 陷阱

你能否举出这样一个合法的 Java 表达式，只要对它的某个子表达式加上括号就可以使其成为不合法的表达式，而添加的括号只是为了注解未加括号时赋值的顺序？  

**插入一对用来注解现有赋值顺序的括号，对程序的合法性似乎是应该没有任何影响的。事实上，绝大多数情况下确实是没有影响的**。但是，在两种情况下，插入一对看上去没有影响的括号，可能会令合法的 Java 程序变得不法。这种奇怪的情况是由于数值的二进制补码的不对称性引起的。

## 解惑

**规则**：**最小的 int 型负数其绝对值比最大的 int 型正数大 1**：Integer.MIN_VALUE 是-2^31，即-2,147,483,648，而 Integer.MAX_VALUE 是 2^31-1，即 2,147,483,647。  

**规则**：**Java 不支持负的十进制字面常量；int 和 long 类型的负数常量都是由正数十进制字面常量前加一元负操作符（-）构成**。

这种构成方式是由一条特殊的语言规则所决定的：**在 int 类型的十进制字面常量中，最大的是 2147483648** 。而从 0 到 2147483647 的所有十进制字面常量都可以在任何能够使用 int 类型字面常量的地方出现，但是**字面常量 2147483648 只能作为一元负操作符的操作数来使用**。 **符号 -2147483648 构成了一个合法的 Java 表达式，它由一元负操作符加上一个 int 型字面常量 2147483648 组成**。

**通过添加一对括号来注解（很不重要的）赋值顺序，即写成 -(2147483648)，就会破坏这条规则**。信不信由你，下面这个程序肯定会出现一个编译期错误，如果去掉了括号，那么错误也就没有了：  

```java
public class PoisonParen {
    int i = -(2147483648);
}
```

类似地，上述情况也适用于 long 型字面常量。下面这个程序也会产生一个编译期错误，并且如果你去掉括号错误也会消失：

```java
public class PoisonParen {
    long j = -(9223372036854774808L);
}  
```


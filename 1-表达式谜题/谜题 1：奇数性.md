# 谜题 1：奇数性  

## 背景

奇数可以被定义为被 2 整除余数为 1 的整数。

## 代码

下面的方法意图确定它那唯一的参数是否是一个奇数。这个方法能够正确运转吗？  

```java
public static boolean isOdd(int i){
    return i % 2 == 1;
} 
```

## 陷阱

表达式 i % 2 计算的是 i 整除 2时所产生的余数，因此看起来这个程序应该能够正确运转。遗憾的是，它不能；它在四分之一的时间里返回的都是错误的答案。  

为什么是四分之一？因为在所有的 int 数值中，有一半都是负数，而 isOdd 方法**对于对所有负奇数的判断都会失败**。在任何负整数上调用该方法都回返回false ，不管该整数是偶数还是奇数。  

## 解惑

Java 对取余操作符（%）的定义所产生的后果，该操作符被定义为：对于所有的 int 数值 a 和所有的非零 int 数值 b，都满足下面的恒等式：

```java
(a / b) * b + (a % b) == a  
```

换句话说，如果你用 b 整除 a，将商乘以 b，然后加上余数，那么你就得到了最初的值 a 。  意味着：当取余操作返回一个非零的结果时，它与左操作数具有相同的正负符号。  **当 i 是一个负奇数时，i % 2 等于-1 而不是 1**。

## 解决办法或规则

**订正**：**只需将 i % 2 与 0 而不是与 1 比较**，并且反转比较的含义即可：

```java
public static boolean isOdd(int i){
    return i % 2 != 0;
}  
```

用位操作符 AND（&）来替代取余操作符性能会更好：

```java
public static boolean isOdd(int i){
    return (i & 1) != 0;
}  
```

总之，无论你何时使用到了取余操作符，都要考虑到操作数和结果的符号。  